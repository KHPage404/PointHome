<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pointhome.www.user.dao.face.UserDao">

	<insert id="insertUser" parameterType="User">
		INSERT INTO user_tb (
			user_no,
			user_name,
			user_pw,
			user_nick,
			user_email,
			user_gender,
			user_birthyear,
			user_birthmonth,
			user_birthday,
			user_phone,
			user_postcode,
			user_address,
			user_detailaddress,
			user_extraaddress
			)
		VALUES (
			user_tb_seq.nextval, 
			#{userName},
			#{userPw},
			#{userNick},
			#{userEmail},
			#{userGender},
			#{userBirthYear},
			#{userBirthMonth},
			#{userBirthDay},
			#{userPhone},
			#{userPostCode},
			#{userAddress},
			#{userDetailAddress},
			#{userExtraAddress}
			)
	</insert>

	<select id="selectCntByUserEmailPw" resultType="int" parameterType="User">
		SELECT count(*) FROM user_tb
		WHERE 1=1 AND 
			user_email = #{userEmail} AND
			user_pw = #{userPw}
	</select>	

	<select id="selectByUserEmailPw" resultType="User" parameterType="User">
		SELECT user_no FROM user_tb
		WHERE 1=1 AND 
			user_email = #{userEmail} AND
			user_pw = #{userPw}
	</select>	
	 
	<select id="selectByUserId" resultType="User" parameterType="int">
		SELECT * FROM user_tb
		WHERE user_no = #{userNo}
	</select>
	
	<select id="selectCntByUserEmail" resultType="int" parameterType="User">
		SELECT count(*) FROM user_tb
		WHERE 1=1
			AND user_email = #{userEmail} 
			AND user_phone = #{userPhone} 
	</select>
	
	<update id="updateUser" parameterType="User">
		UPDATE user_tb 
		SET
	 	user_nick = #{userNick},
	 	user_phone = #{userPhone},
	 	user_postcode = #{userPostCode},
	 	user_address = #{userAddress},
		user_detailaddress = #{userDetailAddress},
		user_extraaddress = #{userExtraAddress}
		WHERE
		user_no = #{userNo}
	</update>
	
	<delete id="deleteFile" parameterType="UserFile">
		DELETE userfile_tb
		WHERE user_no = #{userNo}
	</delete>
	
	<insert id="insertFile" parameterType="UserFile">
		INSERT INTO userfile_tb
		(userfile_no
		, user_no
		, user_img)
		VALUES (userfile_tb_seq.nextval, #{userNo}, #{userImg})

	</insert>
	
</mapper>